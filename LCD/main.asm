.INCLUDE "m328Pdef.inc"
	LDI	R16,	LOW(RAMEND)
	OUT	SPL,	R16
	LDI	R16,	HIGH(RAMEND)
	OUT	SPH,	R16

	LDI 	R16,	0x00
	LDI	R17,	0xFF

	OUT	DDRD,	R17;WRITE
	OUT	DDRC,	R17;WRITE

	;INITIALIZE DISPLAY
	LDI	R18,	0x38
	CALL	INIT
	LDI	R18,	0x0E
	CALL	INIT
	LDI	R18,	0x01
	CALL	INIT
	LDI	R18,	0x02
	CALL	INIT

	;WRITE CHARS
	LDI	R18,	0b01001010;J
	CALL	WRITE
	SLEEP
INIT:
	CBI	PORTC,	1	;RS=0
	CALL	DELAY
	OUT	PORTD,	R17
	CALL	DELAY
        SBI     PORTC,  1       ;E=1
        CALL    DELAY
	CBI	PORTC,	0	;E=0

WRITE:
	SBI	PORTC,	1	;RS=1
	CALL	DELAY
	CBI	PORTC,	0	;E=0
	CALL	DELAY
	OUT	PORTD,	R18
	CALL	DELAY
	SBI	PORTC,	0	;E=1
	CALL	DELAY
	CBI	PORTC,	0	;E=0
	RET

DELAY:
	LDI	R20,	0XFF
	LDI	R21,	0XFF
	RET
T1:	
	NOP
	NOP
	NOP
	DEC	R20
	BRNE	T1
	DEC	R21
	BRNE	T1
	RET

